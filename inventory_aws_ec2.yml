plugin: aws_ec2
regions:
  - us-east-1

filters:
  tag:Project: webdev-lab
  instance-state-name: ["running"]

strict: no
hostnames:
  - private-dns-name

keyed_groups:
  - key: tags.Role
    prefix: tag_Role

compose:
  ansible_host: |
    public_ip_address if tags.get('Role') == 'Bastion' else private_ip_address
  public_ip_address: public_ip_address
  private_ip_address: private_ip_address
