plugin: aws_ec2
regions:
  - us-east-1
filters:
  tag:Project: webdev
  instance-state-name: ["running"]
strict: no
hostnames:
  - private-dns-name
keyed_groups:
  - key: tags.Role
    prefix: tag_Role
compose:
  ansible_host: >-
    {%- if tags.Role == 'Bastion' -%}
    {{ public_ip_address }}
    {%- else -%}
    {{ private_ip_address }}
    {%- endif -%}
  public_ip_address: '{{ public_ip_address }}'
  private_ip_address: '{{ private_ip_address }}'
  ansible_user: admin
  ansible_ssh_private_key_file: "/home/admin/.ssh/labsuser.pem"
